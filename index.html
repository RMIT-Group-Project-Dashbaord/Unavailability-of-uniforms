<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Uniform Availability Survey Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            /* Dark Mode Palette */
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --accent-color: #4db6ac; /* Lighter Teal for Dark Mode */
            --grid-color: #333333;
        }

        body {
            font-family: 'Avenir Next', 'Segoe UI', Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
        }

        .header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #333;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header h1 {
            margin: 0;
            font-weight: 600;
            color: #ffffff;
            font-size: 1.8rem;
        }

        .header p {
            margin: 5px 0 0;
            color: var(--text-secondary);
        }

        /* KPI Section */
        .kpi-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            text-align: center;
            border: 1px solid #333;
            transition: transform 0.3s ease;
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-color);
        }

        .kpi-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--accent-color);
        }

        .kpi-label {
            color: var(--text-secondary);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-top: 5px;
        }

        /* Charts Grid */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        /* Mobile Adjustments */
        @media (max-width: 600px) {
            .grid-container {
                grid-template-columns: 1fr; /* Stack on phone */
            }
            .header {
                flex-direction: column;
                align-items: flex-start;
            }
            .header h1 {
                font-size: 1.5rem;
            }
        }

        .chart-card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            border: 1px solid #333;
            display: flex;
            flex-direction: column;
        }

        .chart-title {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 20px;
            color: #ffffff;
            border-left: 4px solid var(--accent-color);
            padding-left: 12px;
        }

        .canvas-container {
            position: relative;
            height: 300px; /* Fixed height for consistency */
            width: 100%;
        }

        canvas {
            width: 100% !important;
            height: 100% !important;
        }
    </style>
</head>
<body>

    <div class="header">
        <div>
            <h1>Uniform Survey</h1>
            <p>Environmental & Sustainable Systems Engineering</p>
        </div>
        <div>
            <p style="font-size: 0.9rem; text-align: right;">Data Updated: <strong>29th Nov 2025</strong></p>
        </div>
    </div>

    <div class="kpi-container">
        <div class="kpi-card">
            <div class="kpi-number" id="totalResponses">0</div>
            <div class="kpi-label">Total Responses</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-number" id="ecoInterest">0%</div>
            <div class="kpi-label">Prioritize Eco-Friendly</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-number" id="recyclingIntent">0%</div>
            <div class="kpi-label">Willing to Recycle</div>
        </div>
    </div>

    <div class="grid-container" id="chartsGrid">
        <!-- Charts will be injected here via JS -->
    </div>

<script>
    // --- 1. Data (Professional & Distributed) ---
    const surveyData = [
        {id:1, last:"2+ years", fit:10, mat:9, cost:8, days:"on the day", stock:"not applicable [ as the school provided uniforms ]", discard:"Downcycled them - into floor mops, etc.", allPurp:10, life:3, del:"Three months", live:null, price:10, eco:"Yes, I specifically look for eco-friendly uniforms", supp:1, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:2, last:"1-2 years", fit:8, mat:8, cost:7, days:"10 days", stock:"A month before the first day - never back in stock since", discard:"Gave them away to others - kids of workers", allPurp:3, life:2, del:"7 days", live:7, price:1, eco:"Yes, I specifically look for eco-friendly uniforms", supp:3, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:3, last:"1-2 years", fit:10, mat:10, cost:9, days:"20 days", stock:"not applicable [ as the school provided uniforms ]", discard:"Downcycled them - into floor mops, etc.", allPurp:1, life:2, del:"7 days", live:10, price:10, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:1, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:4, last:"", fit:7, mat:7, cost:10, days:"", stock:"A month before the first day - never back in stock since", discard:"Gave them away to others - kids of workers", allPurp:10, life:2, del:"", live:10, price:null, eco:"Yes, I specifically look for eco-friendly uniforms", supp:5, recycled:"Yes, I don't mind", incentive:"Yes"},
        {id:5, last:"2+ years", fit:10, mat:10, cost:6, days:"10 days", stock:"not applicable [ as the school provided uniforms ]", discard:"Gave them away to others - kids of workers", allPurp:10, life:3, del:"Three months", live:1, price:10, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:5, recycled:"No, I would prefer brand new uniforms", incentive:"No"},
        {id:6, last:"3-6 months", fit:10, mat:9, cost:8, days:"on the day", stock:"not applicable [ as the school provided uniforms ]", discard:"Downcycled them - into floor mops, etc.", allPurp:1, life:2, del:"7 days", live:1, price:1, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:1, recycled:"Yes, I don't mind", incentive:"Yes"},
        {id:7, last:"6-12 months", fit:5, mat:8, cost:9, days:"20 days", stock:"A month before the first day - but got restocked quick", discard:"Gave them away to others - kids of workers", allPurp:6, life:2, del:"A month", live:8, price:1, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:3, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:8, last:"3-6 months", fit:9, mat:10, cost:5, days:"a day before the first day", stock:"Almost never ran out of stock", discard:"Downcycled them - into floor mops, etc.", allPurp:2, life:1, del:"Three months", live:1, price:10, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:5, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:9, last:"1-2 years", fit:8, mat:7, cost:8, days:"20 days", stock:"A month before the first day - but got restocked quick", discard:"Downcycled them - into floor mops, etc.", allPurp:8, life:1, del:"7 days", live:7, price:5, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:3, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:10, last:"1-2 years", fit:9, mat:10, cost:9, days:"a day before the first day", stock:"not applicable [ as the school provided uniforms ]", discard:"Gave them away to others - kids of workers", allPurp:8, life:2, del:"Three months", live:1, price:1, eco:"Yes, I specifically look for eco-friendly uniforms", supp:2, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:11, last:"3-6 months", fit:6, mat:9, cost:10, days:"a day before the first day", stock:"not applicable [ as the school provided uniforms ]", discard:"Downcycled them - into floor mops, etc.", allPurp:10, life:3, del:"Three months", live:10, price:10, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:5, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:12, last:"2+ years", fit:10, mat:6, cost:5, days:"a day before the first day", stock:"not applicable [ as the school provided uniforms ]", discard:"Downcycled them - into floor mops, etc.", allPurp:10, life:3, del:"Three months", live:10, price:10, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:5, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:13, last:"3-6 months", fit:10, mat:8, cost:8, days:"a day before the first day", stock:"Almost never ran out of stock", discard:"Usually disposed into landfills", allPurp:10, life:3, del:"7 days", live:10, price:1, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:5, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:14, last:"3-6 months", fit:10, mat:5, cost:5, days:"a day before the first day", stock:"A month before the first day - but got restocked quick", discard:"Gave them away to others - kids of workers", allPurp:10, life:3, del:"A month", live:3, price:6, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:2, recycled:"Yes, I don't mind", incentive:"Yes"},
        {id:15, last:"1-2 years", fit:7, mat:9, cost:9, days:"a day before the first day", stock:"not applicable [ as the school provided uniforms ]", discard:"Downcycled them - into floor mops, etc.", allPurp:9, life:3, del:"A month", live:8, price:5, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:3, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:16, last:"6-12 months", fit:6, mat:8, cost:6, days:"a day before the first day", stock:"Almost never ran out of stock", discard:"Downcycled them - into floor mops, etc.", allPurp:10, life:3, del:"Three months", live:1, price:1, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:5, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:17, last:"6-12 months", fit:10, mat:10, cost:10, days:"10 days", stock:"not applicable [ as the school provided uniforms ]", discard:"Downcycled them - into floor mops, etc.", allPurp:10, life:3, del:"Three months", live:10, price:10, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:5, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:18, last:"2+ years", fit:10, mat:9, cost:9, days:"on the day", stock:"A month before the first day - never back in stock since", discard:"Downcycled them - into floor mops, etc.", allPurp:10, life:3, del:"Three months", live:10, price:9, eco:"Yes, I specifically look for eco-friendly uniforms", supp:4, recycled:"Yes, I don't mind", incentive:"Yes"},
        {id:19, last:"1-2 years", fit:8, mat:10, cost:8, days:"on the day", stock:"Almost never ran out of stock", discard:"Downcycled them - into floor mops, etc.", allPurp:7, life:2, del:"A month", live:9, price:9, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:4, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:20, last:"2+ years", fit:10, mat:7, cost:7, days:"on the day", stock:"A month before the first day - but got restocked quick", discard:"Downcycled them - into floor mops, etc.", allPurp:7, life:2, del:"A month", live:4, price:4, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:3, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:21, last:"2+ years", fit:6, mat:8, cost:6, days:"on the day", stock:"not applicable [ as the school provided uniforms ]", discard:"Downcycled them - into floor mops, etc.", allPurp:10, life:3, del:"Three months", live:10, price:10, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:1, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:22, last:"6-12 months", fit:9, mat:10, cost:9, days:"20 days", stock:"A month before the first day - but got restocked quick", discard:"Gave them away to others - kids of workers", allPurp:10, life:2, del:"7 days", live:10, price:10, eco:"Yes, I specifically look for eco-friendly uniforms", supp:5, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:23, last:"1-2 years", fit:10, mat:8, cost:5, days:"20 days", stock:"not applicable [ as the school provided uniforms ]", discard:"Gave them away to others - kids of workers", allPurp:10, life:3, del:"7 days", live:10, price:1, eco:"Yes, I specifically look for eco-friendly uniforms", supp:2, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:24, last:"1-2 years", fit:10, mat:9, cost:9, days:"a day before the first day", stock:"A month before the first day - but got restocked quick", discard:"Downcycled them - into floor mops, etc.", allPurp:2, life:2, del:"A month", live:10, price:null, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:1, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:25, last:"3-6 months", fit:8, mat:6, cost:6, days:"10 days", stock:"A month before the first day - but got restocked quick", discard:"Downcycled them - into floor mops, etc.", allPurp:1, life:1, del:"7 days", live:1, price:1, eco:"Yes, I specifically look for eco-friendly uniforms", supp:1, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:26, last:"6-12 months", fit:6, mat:10, cost:10, days:"on the day", stock:"not applicable [ as the school provided uniforms ]", discard:"Gave them away to others - kids of workers", allPurp:3, life:1, del:"7 days", live:4, price:1, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:1, recycled:"Yes, I don't mind", incentive:"Yes"},
        {id:27, last:"6-12 months", fit:8, mat:8, cost:8, days:"10 days", stock:"A month before the first day - but got restocked quick", discard:"Downcycled them - into floor mops, etc.", allPurp:8, life:1, del:"7 days", live:6, price:1, eco:"No, I do not filter on the basis of eco-friendly-ness", supp:1, recycled:"No, I would prefer brand new uniforms", incentive:"No"},
        {id:28, last:"3-6 months", fit:7, mat:10, cost:10, days:"10 days", stock:"not applicable [ as the school provided uniforms ]", discard:"Downcycled them - into floor mops, etc.", allPurp:5, life:2, del:"Three months", live:10, price:6, eco:"Yes, I specifically look for eco-friendly uniforms", supp:3, recycled:"Yes, I don't mind", incentive:"Yes"},
        {id:29, last:"6-12 months", fit:9, mat:9, cost:9, days:"10 days", stock:"A month before the first day - never back in stock since", discard:"Downcycled them - into floor mops, etc.", allPurp:10, life:2, del:"7 days", live:10, price:3, eco:"Yes, I specifically look for eco-friendly uniforms", supp:3, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"},
        {id:30, last:"6-12 months", fit:9, mat:10, cost:10, days:"20 days", stock:"A month before the first day - but got restocked quick", discard:"Usually disposed into landfills", allPurp:1, life:2, del:"7 days", live:10, price:5, eco:"Yes, I specifically look for eco-friendly uniforms", supp:3, recycled:"No, I would prefer brand new uniforms", incentive:"Yes"}
    ];

    // --- 2. Data Processing ---

    function getCounts(key) {
        const counts = {};
        surveyData.forEach(row => {
            let val = row[key];
            if (val === "" || val === null) return;
            if (typeof val === 'string') {
                if (val.includes("floor mops")) val = "Downcycled";
                if (val.includes("kids of workers")) val = "Donated";
                if (val.includes("landfills")) val = "Landfill";
                if (val.includes("school provided")) val = "School Provided";
                if (val.includes("specifically look")) val = "Yes";
                if (val.includes("do not filter")) val = "No";
                if (val.includes("Almost never")) val = "Reliable Stock";
                if (val.includes("never back in stock")) val = "Long-term Outage";
                if (val.includes("restocked quick")) val = "Short-term Outage";
                if (val.includes("on the day")) val = "On the Day";
                if (val.includes("a day before")) val = "1 Day Before";
                if (val === "t-1") val = "1 Day Before";
            }
            counts[val] = (counts[val] || 0) + 1;
        });
        return counts;
    }

    function prepareChartData(key) {
        const counts = getCounts(key);
        const labels = Object.keys(counts).sort((a,b) => {
            if(!isNaN(a) && !isNaN(b)) return Number(a) - Number(b);
            return a.localeCompare(b);
        });
        const data = labels.map(l => counts[l]);
        return { labels, data };
    }

    // --- 3. KPI Logic ---
    document.getElementById('totalResponses').innerText = surveyData.length;
    const ecoCount = surveyData.filter(d => d.eco && d.eco.includes("specifically look")).length;
    document.getElementById('ecoInterest').innerText = Math.round((ecoCount / surveyData.length) * 100) + "%";
    const recycleCount = surveyData.filter(d => d.incentive === "Yes").length;
    document.getElementById('recyclingIntent').innerText = Math.round((recycleCount / surveyData.length) * 100) + "%";

    // --- 4. Chart Configuration with Axes Labels ---

    const chartConfigs = [
        { title: "Longevity of Last Uniform", key: "last", type: "pie", xLabel: null, yLabel: null },
        { title: "Importance of Fit (1-10)", key: "fit", type: "bar", xLabel: "Rating (1=Low, 10=High)", yLabel: "Number of Respondents" },
        { title: "Importance of Material (1-10)", key: "mat", type: "bar", xLabel: "Rating (1=Low, 10=High)", yLabel: "Number of Respondents" },
        { title: "Importance of Cost (1-10)", key: "cost", type: "bar", xLabel: "Rating (1=Low, 10=High)", yLabel: "Number of Respondents" },
        { title: "Purchase Timing", key: "days", type: "doughnut", xLabel: null, yLabel: null },
        { title: "Supplier Reliability", key: "stock", type: "bar", indexAxis: 'y', xLabel: "Number of Respondents", yLabel: "Experience" },
        { title: "Disposal Method", key: "discard", type: "doughnut", xLabel: null, yLabel: null },
        { title: "Value of All-Purpose Uniform", key: "allPurp", type: "bar", xLabel: "Rating (1-10)", yLabel: "Number of Respondents" },
        { title: "Ideal Lifespan (Years)", key: "life", type: "bar", xLabel: "Years", yLabel: "Number of Respondents" },
        { title: "Desired Delivery Time", key: "del", type: "pie", xLabel: null, yLabel: null },
        { title: "Value of Live Updates", key: "live", type: "bar", xLabel: "Rating (1-10)", yLabel: "Number of Respondents" },
        { title: "Ideal Price (% of Annual Fees)", key: "price", type: "line", xLabel: "% of Fees", yLabel: "Number of Respondents" },
        { title: "Prefers Eco-Friendly?", key: "eco", type: "pie", xLabel: null, yLabel: null },
        { title: "Ideal Number of Suppliers", key: "supp", type: "bar", xLabel: "Number of Suppliers", yLabel: "Votes" },
        { title: "Willing to use Recycled?", key: "recycled", type: "doughnut", xLabel: null, yLabel: null },
        { title: "Motivated by Incentive?", key: "incentive", type: "pie", xLabel: null, yLabel: null }
    ];

    // --- 5. Rendering with Dark Mode & Axes ---

    const container = document.getElementById('chartsGrid');
    
    // Professional Dark Mode Palette
    const palette = [
        '#4db6ac', '#29b6f6', '#9ccc65', '#ffca28', '#ef5350', '#ab47bc', '#78909c', '#26a69a'
    ];

    // Set Global Defaults for Dark Mode
    Chart.defaults.color = '#e0e0e0';
    Chart.defaults.borderColor = '#333333';
    Chart.defaults.font.family = "'Avenir Next', 'Segoe UI', sans-serif";

    chartConfigs.forEach((config, index) => {
        const card = document.createElement('div');
        card.className = 'chart-card';
        
        const title = document.createElement('div');
        title.className = 'chart-title';
        title.innerText = (index + 1) + ". " + config.title;
        
        const canvasContainer = document.createElement('div');
        canvasContainer.className = 'canvas-container';
        
        const canvas = document.createElement('canvas');
        canvas.id = `chart-${index}`;
        
        canvasContainer.appendChild(canvas);
        card.appendChild(title);
        card.appendChild(canvasContainer);
        container.appendChild(card);

        const chartData = prepareChartData(config.key);

        const isPie = config.type === 'pie' || config.type === 'doughnut';

        // Custom Scales Configuration for Dark Mode
        const scalesConfig = isPie ? {} : {
            x: {
                title: {
                    display: !!config.xLabel,
                    text: config.xLabel || '',
                    color: '#a0a0a0',
                    font: { size: 12, weight: 600 }
                },
                grid: { color: '#333333' },
                ticks: { color: '#e0e0e0' }
            },
            y: {
                title: {
                    display: !!config.yLabel,
                    text: config.yLabel || '',
                    color: '#a0a0a0',
                    font: { size: 12, weight: 600 }
                },
                grid: { color: '#333333' },
                ticks: { color: '#e0e0e0', stepSize: 1 },
                beginAtZero: true
            }
        };

        new Chart(canvas, {
            type: config.type,
            data: {
                labels: chartData.labels,
                datasets: [{
                    label: 'Respondents',
                    data: chartData.data,
                    backgroundColor: config.type === 'line' ? 'rgba(77, 182, 172, 0.2)' : palette,
                    borderColor: config.type === 'line' ? '#4db6ac' : '#1e1e1e',
                    borderWidth: 2,
                    fill: config.type === 'line',
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: config.indexAxis || 'x',
                plugins: {
                    legend: {
                        display: isPie,
                        position: 'bottom',
                        labels: { padding: 20, color: '#e0e0e0' }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(30, 30, 30, 0.9)',
                        titleColor: '#ffffff',
                        bodyColor: '#e0e0e0',
                        borderColor: '#4db6ac',
                        borderWidth: 1,
                        padding: 10
                    }
                },
                scales: scalesConfig,
                animation: {
                    duration: 1500,
                    easing: 'easeOutQuart',
                    delay: (context) => context.dataIndex * 100 // Staggered animation
                }
            }
        });
    });

</script>
</body>
</html>